{"version":3,"sources":["webpack:///webpack/bootstrap 2883b7cc1dfe1571004f","webpack:///./startServer.js","webpack:///external \"commonjsampersand-app\"","webpack:///./server.js","webpack:///external \"commonjshapi\"","webpack:///external \"commonjsinert\"","webpack:///external \"commonjsvision\"","webpack:///external \"commonjslout\"","webpack:///external \"commonjshapi-auth-cookie\"","webpack:///external \"commonjsglob\"","webpack:///external \"path\"","webpack:///./dbConnection.js","webpack:///./cookiePassword.js","webpack:///external \"commonjsauto-sni\"","webpack:///. ^\\.\\/.*$","webpack:///./alexPassword.js","webpack:///./configuration.js","webpack:///./dbPass.json","webpack:///./gulp-tasks/prod_clean_dist.js","webpack:///external \"commonjsgulp\"","webpack:///external \"commonjsdel\"","webpack:///./gulp-tasks/prod_copy.js","webpack:///external \"commonjsrequire-dir\"","webpack:///./gulp-tasks/prod_copy_etc_to_dist.js","webpack:///./gulp-tasks/prod_copy_geojson_to_dist.js","webpack:///./gulp-tasks/prod_copy_img_to_dist.js","webpack:///./gulp-tasks/prod_copy_kml_to_dist.js","webpack:///./gulp-tasks/prod_copy_queries_to_dist.js","webpack:///./gulp-tasks/prod_copy_root_to_dist.js","webpack:///./gulp-tasks/prod_copy_src_to_dist.js","webpack:///./gulp-tasks/prod_sftp.js","webpack:///external \"commonjsgulp-sftp\"","webpack:///./sftpPass.json","webpack:///./gulpfile.js","webpack:///./license.md","webpack:///./package.json","webpack:///./secretKey.js","webpack:///./src/escapeStringForSql.js","webpack:///./src/exportData.js","webpack:///./src/getObjectById.js","webpack:///./src/getPropertyCollectionsByObject.js","webpack:///./src/getRelationCollectionsByObject.js","webpack:///./src/getRelationsByORC.js","webpack:///./src/getRelationPartnersByRelation.js","webpack:///./src/getTaxonomies.js","webpack:///./src/getTaxonomiesByObject.js","webpack:///./src/getUsers.js","webpack:///./src/handlers/objectById.js","webpack:///external \"commonjsboom\"","webpack:///./src/handlers/taxonomies.js","webpack:///./src/handlers/users/create.js","webpack:///./src/hashPassword.js","webpack:///external \"commonjsbcrypt\"","webpack:///./src/handlers/users/login.js","webpack:///external \"commonjsuuid\"","webpack:///./src/verifyUser.js","webpack:///./src/handlers/users/logout.js","webpack:///./src/handlers/users/users.js","webpack:///./src/nonQueryRoutes/nonQueries.js","webpack:///./src/routes/exportData.js","webpack:///./src/routes/object.js","webpack:///external \"commonjsjoi\"","webpack:///./src/routes/taxonomies.js","webpack:///./src/routes/users/create.js","webpack:///./src/verifyUniqueUser.js","webpack:///./src/routes/users/login.js","webpack:///./src/routes/users/logout.js","webpack:///./src/routes/users/users.js","webpack:///external \"commonjspg-promise\""],"names":[],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,EAAC;;;;;;;ACrBD,wC;;;;;;ACAA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,oCAAmC,kBAAkB;AACrD,+CAA8B,KAAK;AACnC;AACA;AACA;AACA,4CAA2C,kBAAkB;AAC7D,+CAA8B,KAAK;AACnC;AACA,EAAC;;AAED;;;;;;;;AC3EA,+B;;;;;;ACAA,gC;;;;;;ACAA,iC;;;;;;ACAA,+B;;;;;;ACAA,2C;;;;;;ACAA,+B;;;;;;ACAA,kC;;;;;;ACAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACbA;;AAEA;;;;;;;ACFA,mC;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,uDAAuD;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC5GA;;AAEA;;;;;;;ACFA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,4CAA2C,YAAY,GAAG,YAAY;;AAEtE;;;;;;;ACfA;AACA;AACA;AACA,G;;;;;;ACHA;;AAEA;AACA;;AAEA;AACA;AACA,EAAC;;;;;;;ACPD,+B;;;;;;ACAA,8B;;;;;;ACAA;;AAEA;AACA;;AAEA,8BAA6B,gBAAgB;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACpBA,sC;;;;;;ACAA;;AAEA;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;ACPD;;AAEA;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;ACPD;;AAEA;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;ACPD;;AAEA;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;ACPD;;AAEA;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;ACPD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;;;;;AChBD;;AAEA;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;ACPD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,8BAA6B,cAAc;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;;;;;;ACvBD,oC;;;;;;ACAA;AACA;AACA;AACA,G;;;;;;ACHA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,6BAA4B,gBAAgB;;;;;;;ACnB5C,g0BAA+zB,qCAAqC,+BAA+B,OAAO,qiB;;;;;;ACA14B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACrDA;;AAEA;;;;;;;ACFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;;;;;;AC/BA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,oBAAmB,WAAW;AAC9B;AACA;AACA;AACA,+BAA8B,qBAAqB;AACnD;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;;;;;;AC9BA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;ACpBH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;;ACvBH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,QAAO;AACP;AACA,IAAG;;;;;;;ACvCH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,QAAO;AACP;AACA,IAAG;;;;;;;ACrCH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;ACpBH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;AClBH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;AChCH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;AClBH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;;;;;;ACjGA,+B;;;;;;ACAA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;;;;;;AChBA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS,wBAAwB;;AAEjC;AACA;AACA;AACA;AACA;AACA,oBAAmB,KAAK,KAAK,MAAM,KAAK,KAAK;AAC7C;AACA;AACA;AACA,0CAAyC,KAAK;AAC9C;AACA;AACA;AACA;AACA;;;;;;;ACvBA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL,IAAG;;;;;;;ACbH,iC;;;;;;ACAA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS,iBAAiB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC,2BAA0B,UAAU;AACpC,MAAK;AACL;AACA;;;;;;;ACvBA,+B;;;;;;ACAA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;;;;;;ACpCH;;AAEA;AACA;AACA;AACA;;;;;;;ACLA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;;;;;;AChBA;;AAEA;AACA;AACA;AACA,cAAa,MAAM;AACnB;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACrCA;;AAEA;;AAEA;AACA;AACA,uBAAsB,kBAAkB,EAAE,kBAAkB,EAAE,wBAAwB,EAAE,8BAA8B,EAAE,cAAc;AACtI;AACA;;;;;;;ACRA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAkB,GAAG;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;;;;;;ACjBA,8B;;;;;;ACAA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACXA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;;;;;;ACvBA;;AAEA;AACA;;AAEA;AACA,UAAS,cAAc;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;;;;;;ACpCA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;;;;;;AClBA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;ACRA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBA,qC","file":"backend.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2883b7cc1dfe1571004f\n **/","/**\r\n * startet die Anwendung, indem der Server gestartet wird\r\n */\r\n\r\n'use strict'\r\n\r\nconst app = require('ampersand-app')\r\nconst server = require('./server.js')\r\nconst pgp = require('pg-promise')()\r\nconst config = require('./configuration.js')\r\n\r\nserver.start((err) => {\r\n  if (err) throw err\r\n  const db = pgp(config.pg.connectionString)\r\n  app.extend({\r\n    init() {\r\n      this.db = db\r\n    }\r\n  })\r\n  app.init()\r\n  console.log(`Server running at:`, server.info.uri)\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./startServer.js\n ** module id = 0\n ** module chunks = 0\n **/","module.exports = commonjsampersand-app;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsampersand-app\"\n ** module id = 1\n ** module chunks = 0\n **/","/**\r\n * startet die Anwendung, indem der Server gestartet wird\r\n */\r\n\r\n'use strict'\r\n\r\nconst Hapi = require('hapi')\r\nconst Inert = require('inert')\r\nconst Vision = require('vision')\r\nconst Lout = require('lout')\r\nconst HapiAuthCookie = require('hapi-auth-cookie')\r\nconst glob = require('glob')\r\nconst path = require('path')\r\nconst dbConnection = require('./dbConnection.js')()\r\nconst cookiePassword = require('./cookiePassword.js')\r\n// wird nur in Entwicklung genutzt\r\n// in new Hapi.Server() einsetzen\r\nlet serverOptions = {\r\n  debug: {\r\n    log: ['error'],\r\n    request: ['error']\r\n  }\r\n}\r\nif (process.env.NODE_ENV === 'production') {\r\n  serverOptions = {}\r\n  const createServer = require('auto-sni')\r\n  const secureServer = createServer({\r\n    email: 'alex@gabriel-software.ch', // Emailed when certificates expire\r\n    agreeTos: true, // Required for letsencrypt\r\n    debug: true, // Add console messages and uses staging LetsEncrypt server. (Disable in production)\r\n    domains: ['artliste.ch'], // List of accepted domain names. (You can use nested arrays to register bundles with LE)\r\n    forceSSL: true, // Make this false to disable auto http->https redirects (default true)\r\n    ports: {\r\n      http: 80, // Optionally override the default http port\r\n      https: 443 // Optionally override the default https port\r\n    }\r\n  })\r\n  // Server is a \"https.createServer\" instance.\r\n  secureServer.once('listening', () => {\r\n    console.log('We are ready to go.')  // eslint-disable-line no-console\r\n  })\r\n  // add auto-sni methods to dbConnection\r\n  dbConnection.listener = secureServer\r\n  dbConnection.autoListen = false\r\n  dbConnection.tls = true\r\n}\r\nconst server = new Hapi.Server(serverOptions)\r\nserver.connection(dbConnection)\r\n\r\nconst loutConfig = {\r\n  register: Lout,\r\n  options: {\r\n    endpoint: 'api'\r\n  }\r\n}\r\n\r\nserver.register([Inert, HapiAuthCookie, Vision, loutConfig], (error) => {\r\n  if (error) console.log('failed loading server plugins')  // eslint-disable-line no-console\r\n  server.auth.strategy('session', 'cookie', true, {\r\n    password: cookiePassword,\r\n    cookie: 'ae-cookie',\r\n    ttl: 24 * 60 * 60 * 1000, // set session to 1 day\r\n    isSecure: process.env.NODE_ENV !== 'development' // bad idea but necessary to run on http\r\n  })\r\n  // add all the routes\r\n  glob.sync('src/routes/**/*.js', { root: __dirname }).forEach((file) =>\r\n    server.route(require(`./${file}`))\r\n  )\r\n  // non-Query routes hat to be separated\r\n  // because when testing directory handler produces an error\r\n  glob.sync('src/nonQueryRoutes/**/*.js', { root: __dirname }).forEach((file) =>\r\n    server.route(require(`./${file}`))\r\n  )\r\n})\r\n\r\nmodule.exports = server\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./server.js\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = commonjshapi;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjshapi\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = commonjsinert;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsinert\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = commonjsvision;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsvision\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = commonjslout;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjslout\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = commonjshapi-auth-cookie;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjshapi-auth-cookie\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = commonjsglob;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsglob\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 9\n ** module chunks = 0\n **/","'use strict'\r\n\r\nmodule.exports = () => {\r\n  const connection = {\r\n    host: `0.0.0.0`,\r\n    routes: {\r\n      cors: true\r\n    }\r\n  }\r\n  if (process.env.NODE_ENV === `development`) {\r\n    connection.port = 8000\r\n  }\r\n  return connection\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./dbConnection.js\n ** module id = 10\n ** module chunks = 0\n **/","'use strict'\n\nmodule.exports = `this schall become a very long and secret password when it is finished`\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./cookiePassword.js\n ** module id = 11\n ** module chunks = 0\n **/","module.exports = commonjsauto-sni;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsauto-sni\"\n ** module id = 12\n ** module chunks = 0\n **/","var map = {\n\t\"./alexPassword\": 14,\n\t\"./alexPassword.js\": 14,\n\t\"./configuration\": 15,\n\t\"./configuration.js\": 15,\n\t\"./cookiePassword\": 11,\n\t\"./cookiePassword.js\": 11,\n\t\"./dbConnection\": 10,\n\t\"./dbConnection.js\": 10,\n\t\"./dbPass\": 16,\n\t\"./dbPass.json\": 16,\n\t\"./gulp-tasks/prod_clean_dist\": 17,\n\t\"./gulp-tasks/prod_clean_dist.js\": 17,\n\t\"./gulp-tasks/prod_copy\": 20,\n\t\"./gulp-tasks/prod_copy.js\": 20,\n\t\"./gulp-tasks/prod_copy_etc_to_dist\": 22,\n\t\"./gulp-tasks/prod_copy_etc_to_dist.js\": 22,\n\t\"./gulp-tasks/prod_copy_geojson_to_dist\": 23,\n\t\"./gulp-tasks/prod_copy_geojson_to_dist.js\": 23,\n\t\"./gulp-tasks/prod_copy_img_to_dist\": 24,\n\t\"./gulp-tasks/prod_copy_img_to_dist.js\": 24,\n\t\"./gulp-tasks/prod_copy_kml_to_dist\": 25,\n\t\"./gulp-tasks/prod_copy_kml_to_dist.js\": 25,\n\t\"./gulp-tasks/prod_copy_queries_to_dist\": 26,\n\t\"./gulp-tasks/prod_copy_queries_to_dist.js\": 26,\n\t\"./gulp-tasks/prod_copy_root_to_dist\": 27,\n\t\"./gulp-tasks/prod_copy_root_to_dist.js\": 27,\n\t\"./gulp-tasks/prod_copy_src_to_dist\": 28,\n\t\"./gulp-tasks/prod_copy_src_to_dist.js\": 28,\n\t\"./gulp-tasks/prod_sftp\": 29,\n\t\"./gulp-tasks/prod_sftp.js\": 29,\n\t\"./gulpfile\": 32,\n\t\"./gulpfile.js\": 32,\n\t\"./license.md\": 33,\n\t\"./package\": 34,\n\t\"./package.json\": 34,\n\t\"./secretKey\": 35,\n\t\"./secretKey.js\": 35,\n\t\"./server\": 2,\n\t\"./server.js\": 2,\n\t\"./sftpPass\": 31,\n\t\"./sftpPass.json\": 31,\n\t\"./src/escapeStringForSql\": 36,\n\t\"./src/escapeStringForSql.js\": 36,\n\t\"./src/exportData\": 37,\n\t\"./src/exportData.js\": 37,\n\t\"./src/getObjectById\": 38,\n\t\"./src/getObjectById.js\": 38,\n\t\"./src/getPropertyCollectionsByObject\": 39,\n\t\"./src/getPropertyCollectionsByObject.js\": 39,\n\t\"./src/getRelationCollectionsByObject\": 41,\n\t\"./src/getRelationCollectionsByObject.js\": 41,\n\t\"./src/getRelationPartnersByRelation\": 43,\n\t\"./src/getRelationPartnersByRelation.js\": 43,\n\t\"./src/getRelationsByORC\": 42,\n\t\"./src/getRelationsByORC.js\": 42,\n\t\"./src/getTaxonomies\": 44,\n\t\"./src/getTaxonomies.js\": 44,\n\t\"./src/getTaxonomiesByObject\": 45,\n\t\"./src/getTaxonomiesByObject.js\": 45,\n\t\"./src/getUsers\": 46,\n\t\"./src/getUsers.js\": 46,\n\t\"./src/handlers/objectById\": 47,\n\t\"./src/handlers/objectById.js\": 47,\n\t\"./src/handlers/taxonomies\": 49,\n\t\"./src/handlers/taxonomies.js\": 49,\n\t\"./src/handlers/users/create\": 50,\n\t\"./src/handlers/users/create.js\": 50,\n\t\"./src/handlers/users/login\": 53,\n\t\"./src/handlers/users/login.js\": 53,\n\t\"./src/handlers/users/logout\": 56,\n\t\"./src/handlers/users/logout.js\": 56,\n\t\"./src/handlers/users/users\": 57,\n\t\"./src/handlers/users/users.js\": 57,\n\t\"./src/hashPassword\": 51,\n\t\"./src/hashPassword.js\": 51,\n\t\"./src/nonQueryRoutes/nonQueries\": 58,\n\t\"./src/nonQueryRoutes/nonQueries.js\": 58,\n\t\"./src/routes/exportData\": 59,\n\t\"./src/routes/exportData.js\": 59,\n\t\"./src/routes/object\": 60,\n\t\"./src/routes/object.js\": 60,\n\t\"./src/routes/taxonomies\": 62,\n\t\"./src/routes/taxonomies.js\": 62,\n\t\"./src/routes/users/create\": 63,\n\t\"./src/routes/users/create.js\": 63,\n\t\"./src/routes/users/login\": 65,\n\t\"./src/routes/users/login.js\": 65,\n\t\"./src/routes/users/logout\": 66,\n\t\"./src/routes/users/logout.js\": 66,\n\t\"./src/routes/users/users\": 67,\n\t\"./src/routes/users/users.js\": 67,\n\t\"./src/verifyUniqueUser\": 64,\n\t\"./src/verifyUniqueUser.js\": 64,\n\t\"./src/verifyUser\": 55,\n\t\"./src/verifyUser.js\": 55\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 13;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** . ^\\.\\/.*$\n ** module id = 13\n ** module chunks = 0\n **/","'use strict'\n\nmodule.exports = 'HknvWAY3zMZd'\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./alexPassword.js\n ** module id = 14\n ** module chunks = 0\n **/","/**\r\n * Hier werden zentral alle Konfigurationsparameter gesammelt\r\n */\r\n\r\n'use strict'\r\n\r\nconst config = {}\r\nconst dbPass = require('./dbPass.json')\r\n\r\nconfig.db = {}\r\nconfig.pg = {}\r\nconfig.pg.userName = dbPass.user\r\nconfig.pg.passWord = dbPass.pass\r\nconfig.pg.connectionString = `postgres://${dbPass.user}:${dbPass.pass}@localhost:5432/ae`\r\n\r\nmodule.exports = config\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./configuration.js\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = {\n\t\"user\": \"postgres\",\n\t\"pass\": \"3Q2ernEv51dr\"\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./dbPass.json\n ** module id = 16\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\nconst del = require('del')\r\n\r\ngulp.task('prod_clean_dist', function (cb) {\r\n  del(['dist'], cb)\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_clean_dist.js\n ** module id = 17\n ** module chunks = 0\n **/","module.exports = commonjsgulp;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsgulp\"\n ** module id = 18\n ** module chunks = 0\n **/","module.exports = commonjsdel;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsdel\"\n ** module id = 19\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\nconst requireDir = require('require-dir')\r\n\r\nrequireDir('../gulp-tasks', { recurse: true })\r\n\r\ngulp.task(\r\n  'prod_copy',\r\n  function () {\r\n    gulp.start([\r\n      'prod_copy_geojson_to_dist',\r\n      'prod_copy_src_to_dist',\r\n      'prod_copy_queries_to_dist',\r\n      'prod_copy_img_to_dist',\r\n      'prod_copy_kml_to_dist',\r\n      'prod_copy_etc_to_dist',\r\n      'prod_copy_root_to_dist'\r\n    ])\r\n  }\r\n)\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy.js\n ** module id = 20\n ** module chunks = 0\n **/","module.exports = commonjsrequire-dir;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsrequire-dir\"\n ** module id = 21\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_etc_to_dist', function () {\r\n  return gulp.src('etc/*')\r\n    .pipe(gulp.dest('dist/etc'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_etc_to_dist.js\n ** module id = 22\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_geojson_to_dist', function () {\r\n  return gulp.src('geojson/*')\r\n    .pipe(gulp.dest('dist/geojson'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_geojson_to_dist.js\n ** module id = 23\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_img_to_dist', function () {\r\n  return gulp.src('img/*')\r\n    .pipe(gulp.dest('dist/img'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_img_to_dist.js\n ** module id = 24\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_kml_to_dist', function () {\r\n  return gulp.src('kml/*')\r\n    .pipe(gulp.dest('dist/kml'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_kml_to_dist.js\n ** module id = 25\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_queries_to_dist', function () {\r\n  return gulp.src('src/handlers/**/*')\r\n    .pipe(gulp.dest('dist/handlers'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_queries_to_dist.js\n ** module id = 26\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_root_to_dist', function () {\r\n  return gulp.src([\r\n    'configuration.js',\r\n    'server.js',\r\n    'package.json',\r\n    'License.md',\r\n    'README.md',\r\n    'dbConnection.js',\r\n    'pgPlugin.js',\r\n    'startServer.js'\r\n  ])\r\n    .pipe(gulp.dest('dist/'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_root_to_dist.js\n ** module id = 27\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst gulp = require('gulp')\r\n\r\ngulp.task('prod_copy_src_to_dist', function () {\r\n  return gulp.src(['src/**/*'])\r\n    .pipe(gulp.dest('dist/src'))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_copy_src_to_dist.js\n ** module id = 28\n ** module chunks = 0\n **/","/**\r\n * beamt die Dateien aus dem dist-Ordner nach apflora.ch\r\n */\r\n\r\n'use strict'\r\n\r\nconst gulp = require('gulp')\r\nvar sftp = require('gulp-sftp')\r\nvar requireDir = require('require-dir')\r\nvar sftpPass = require('../sftpPass.json')\r\n\r\nrequireDir('../gulp-tasks', {recurse: true})\r\n\r\ngulp.task('prod_sftp', function () {\r\n  return gulp.src('dist/**/*')\r\n    .pipe(sftp({\r\n      // host: 'api.apflora.ch',\r\n      host: '46.101.153.44',\r\n      port: 30000,\r\n      remotePath: 'apflora',\r\n      user: sftpPass.user,\r\n      pass: sftpPass.pass\r\n    }))\r\n})\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulp-tasks/prod_sftp.js\n ** module id = 29\n ** module chunks = 0\n **/","module.exports = commonjsgulp-sftp;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsgulp-sftp\"\n ** module id = 30\n ** module chunks = 0\n **/","module.exports = {\n\t\"user\": \"alex\",\n\t\"pass\": \"3Q2ernEv51dr\"\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sftpPass.json\n ** module id = 31\n ** module chunks = 0\n **/","/*\r\n\r\n Quelle: https://github.com/greypants/gulp-starter\r\n\r\n gulpfile.js\r\n ===========\r\n Rather than manage one giant configuration file responsible\r\n for creating multiple tasks, each task has been broken out into\r\n its own file in gulp/tasks. Any files in that directory get\r\n automatically required below.\r\n\r\n To add a new task, simply add a new task file that directory.\r\n gulp/tasks/default.js specifies the default set of tasks to run\r\n when you run `gulp`.\r\n */\r\n\r\nconst requireDir = require('require-dir')\r\n\r\n// initiate modularized tasks\r\nrequireDir('./gulp-tasks', { recurse: true })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./gulpfile.js\n ** module id = 32\n ** module chunks = 0\n **/","module.exports = \"<p>Copyright (c) 2014, Amt für Landschaft und Natur Kanton Zürich</p>\\n<p>Alle Rechte vorbehalten.</p>\\n<p>Weiterverbreitung und Verwendung mit oder ohne Veränderung, gratis oder kostenpflichtig, sind zulässig, wenn das obige Copyright, diese Liste der Bedingungen und der folgende Haftungsausschluss enthalten sind.</p>\\n<p>DIESE SOFTWARE WIRD VOM RECHTEINHABER UND DEN BEITRAGSLEISTENDEN OHNE JEGLICHE SPEZIELLE ODER IMPLIZIERTE GARANTIEN ZUR VERFÜGUNG GESTELLT, DIE UNTER ANDEREM EINSCHLIESSEN: DIE IMPLIZIERTE GARANTIE DER VERWENDBARKEIT DER SOFTWARE FÜR EINEN BESTIMMTEN ZWECK. AUF KEINEN FALL SIND DER RECHTEINHABER ODER DIE BEITRAGSLEISTENDEN FÜR IRGENDWELCHE DIREKTEN, INDIREKTEN, ZUFÄLLIGEN, SPEZIELLEN, BEISPIELHAFTEN ODER FOLGESCHÄDEN (UNTER ANDEREM VERSCHAFFEN VON ERSATZGÜTERN ODER -DIENSTLEISTUNGEN; EINSCHRÄNKUNG DER NUTZUNGSFÄHIGKEIT; VERLUST VON NUTZUNGSFÄHIGKEIT; DATEN; PROFIT ODER GESCHÄFTSUNTERBRECHUNG), WIE AUCH IMMER VERURSACHT UND UNTER WELCHER VERPFLICHTUNG AUCH IMMER, OB IN VERTRAG, STRIKTER VERPFLICHTUNG ODER UNERLAUBTER HANDLUNG (INKLUSIVE FAHRLÄSSIGKEIT) VERANTWORTLICH, AUF WELCHEM WEG SIE AUCH IMMER DURCH DIE BENUTZUNG DIESER SOFTWARE ENTSTANDEN SIND, SOGAR, WENN SIE AUF DIE MÖGLICHKEIT EINES SOLCHEN SCHADENS HINGEWIESEN WORDEN SIND.</p>\\n<p>Dies ist eine übersetzte Version der ISC-Lizenz (<a href=\\\"https://en.wikipedia.org/wiki/ISC_license\\\">https://en.wikipedia.org/wiki/ISC_license</a>).</p>\\n\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./license.md\n ** module id = 33\n ** module chunks = 0\n **/","module.exports = {\n\t\"name\": \"ae_api\",\n\t\"version\": \"0.0.1\",\n\t\"description\": \"backend for arteigenschaften.ch\",\n\t\"main\": \"index.js\",\n\t\"scripts\": {\n\t\t\"dev\": \"set NODE_ENV=development&& nodemon startServer.js\",\n\t\t\"start\": \"sudo setcap cap_net_bind_service=+ep $(which node) && set NODE_ENV=production && node startServer.js\",\n\t\t\"test\": \"eslint src/**\",\n\t\t\"yolo\": \"gulp sftp_src && gulp sftp_top\"\n\t},\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"git+https://github.com/barbalex/ae_api.git\"\n\t},\n\t\"author\": \"Alexander Gabriel\",\n\t\"license\": \"ISC\",\n\t\"bugs\": {\n\t\t\"url\": \"https://github.com/barbalex/ae_api/issues\"\n\t},\n\t\"homepage\": \"https://github.com/barbalex/ae_api#readme\",\n\t\"dependencies\": {\n\t\t\"ampersand-app\": \"2.0.0\",\n\t\t\"bcrypt\": \"0.8.7\",\n\t\t\"boom\": \"3.2.2\",\n\t\t\"glob\": \"7.0.5\",\n\t\t\"hapi\": \"13.5.0\",\n\t\t\"hapi-auth-cookie\": \"6.1.1\",\n\t\t\"inert\": \"4.0.1\",\n\t\t\"joi\": \"8.4.2\",\n\t\t\"lodash\": \"4.13.1\",\n\t\t\"lout\": \"9.0.1\",\n\t\t\"node-uuid\": \"1.4.7\",\n\t\t\"pg-promise\": \"5.1.0\",\n\t\t\"uuid\": \"2.0.2\",\n\t\t\"vision\": \"4.1.0\"\n\t},\n\t\"devDependencies\": {\n\t\t\"babel-eslint\": \"6.1.0\",\n\t\t\"code\": \"3.0.1\",\n\t\t\"del\": \"2.2.1\",\n\t\t\"eslint\": \"3.0.1\",\n\t\t\"eslint-config-airbnb\": \"9.0.1\",\n\t\t\"eslint-plugin-import\": \"1.10.2\",\n\t\t\"eslint-plugin-jsx-a11y\": \"1.5.5\",\n\t\t\"eslint-plugin-react\": \"5.2.2\",\n\t\t\"gulp\": \"3.9.1\",\n\t\t\"gulp-sftp\": \"0.1.5\",\n\t\t\"lab\": \"10.8.2\",\n\t\t\"nodemon\": \"1.9.2\",\n\t\t\"require-dir\": \"0.3.0\",\n\t\t\"run-sequence\": \"1.2.2\"\n\t}\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./package.json\n ** module id = 34\n ** module chunks = 0\n **/","'use strict'\r\n\r\nmodule.exports = `secret`\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./secretKey.js\n ** module id = 35\n ** module chunks = 0\n **/","'use strict'\r\n\r\nmodule.exports = (str) => {\r\n  if (str) {\r\n    if (typeof str === `string`) {\r\n      return str.replace(/[\\0\\x08\\x09\\x1a\\n\\r\"'\\\\\\%]/g, (char) => {\r\n        switch (char) {\r\n          case `\\0`:\r\n            return `\\\\0`\r\n          case `\\x08`:\r\n            return `\\\\b`\r\n          case `\\x09`:\r\n            return `\\\\t`\r\n          case `\\x1a`:\r\n            return `\\\\z`\r\n          case `\\n`:\r\n            return `\\\\n`\r\n          case `\\r`:\r\n            return `\\\\r`\r\n          case `\"`:\r\n          case \"'\":  /* eslint quotes:0 */\r\n          case `\\\\`:\r\n          case `%`:\r\n            return `\\\\${char}` // prepends a backslash to backslash, percent and double/single quotes\r\n          default:\r\n            return char\r\n        }\r\n      })\r\n    }\r\n    return str\r\n  }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/escapeStringForSql.js\n ** module id = 36\n ** module chunks = 0\n **/","'use strict'\r\n\r\n/**\r\n * receives options for export\r\n * returns export data\r\n */\r\n\r\nmodule.exports = (request, callback) => {\r\n  return null\r\n  /*\r\n  const {\r\n    exportOptions,\r\n    onlyObjectsWithCollectionData,\r\n    includeDataFromSynonyms,\r\n    oneRowPerRelation,\r\n    combineTaxonomies\r\n  } = request.params\r\n  const dbUrl = `${couchUrl()}/artendb`\r\n  // connect do users db\r\n  new PouchDB(dbUrl)\r\n    // get all objects\r\n    .then((db) => db.allDocs({ include_docs: true }))\r\n    .then((result) => {\r\n      const objects = result.rows.map((row) => row.doc)\r\n    })\r\n    // return roles to caller\r\n    .then((doc) => callback(null, doc.roles))\r\n    // inform caller of error\r\n    .catch((error) => callback(error, null))\r\n  */\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/exportData.js\n ** module id = 37\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\n\r\nmodule.exports = (id) =>\r\n  new Promise((resolve, reject) => {\r\n    const sql = `\r\n      SELECT\r\n        *\r\n      FROM\r\n        ae.object\r\n      WHERE\r\n        id = $1\r\n    `\r\n    app.db.one(sql, [id])\r\n      .then((data) => {\r\n        if (data) return resolve(data)\r\n        reject(`no object received from db`)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getObjectById.js\n ** module id = 38\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\n\r\nmodule.exports = (id) =>\r\n  new Promise((resolve, reject) => {\r\n    const sql = `\r\n      SELECT\r\n        ae.property_collection.*,\r\n        ae.property_collection_object.properties\r\n      FROM\r\n        ae.property_collection_object\r\n        INNER JOIN ae.property_collection\r\n        ON property_collection.id = ae.property_collection_object.property_collection_id\r\n      WHERE\r\n        object_id = $1\r\n    `\r\n    app.db.many(sql, [id])\r\n      .then((data) => {\r\n        if (data) return resolve(data)\r\n        reject(`no object_property_collections received from db`)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getPropertyCollectionsByObject.js\n ** module id = 39\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\nconst getRelationsByORC = require('./getRelationsByORC.js')\r\n\r\nmodule.exports = (object_id) =>\r\n  new Promise((resolve, reject) => {\r\n    let relationCollections\r\n    const sql = `\r\n      SELECT\r\n        ae.relation_collection_object.relation_collection_id,\r\n        ae.relation_collection.*\r\n      FROM\r\n        ae.relation_collection_object\r\n        INNER JOIN ae.relation_collection\r\n        ON relation_collection.id = ae.relation_collection_object.relation_collection_id\r\n      WHERE\r\n        object_id = $1\r\n    `\r\n    app.db.many(sql, [object_id])\r\n      .then((data) => {\r\n        if (data) {\r\n          relationCollections = data\r\n        } else {\r\n          return reject(`no object_relation_collections received from db`)\r\n        }\r\n        return Promise.all(relationCollections.map((oRC) =>\r\n          getRelationsByORC(object_id, oRC.relation_collection_id))\r\n        )\r\n      })\r\n      .then((relationsArray) => {\r\n        relationCollections = relationCollections.map((oRC, index) => {\r\n          delete oRC.relation_collection_id\r\n          oRC.relations = relationsArray[index]\r\n          return oRC\r\n        })\r\n        resolve(relationCollections)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getRelationCollectionsByObject.js\n ** module id = 41\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\nconst getRelationPartnersByRelation = require('./getRelationPartnersByRelation.js')\r\n\r\nmodule.exports = (object_id, relation_collection_id) =>\r\n  new Promise((resolve, reject) => {\r\n    let relations\r\n    const sql = `\r\n      SELECT\r\n        id,\r\n        properties\r\n      FROM\r\n        ae.relation\r\n      WHERE\r\n        object_id = $1 AND\r\n        relation_collection_id = $2\r\n    `\r\n    app.db.many(sql, [object_id, relation_collection_id])\r\n      .then((data) => {\r\n        if (data) {\r\n          relations = data\r\n        } else {\r\n          return reject(`no relations received from db`)\r\n        }\r\n        return Promise.all(relations.map((relation) =>\r\n          getRelationPartnersByRelation(relation.id))\r\n        )\r\n      })\r\n      .then((relationPartnersArray) => {\r\n        relations = relations.map((relation, index) => {\r\n          relation.relationPartners = relationPartnersArray[index]\r\n          return relation\r\n        })\r\n        resolve(relations)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getRelationsByORC.js\n ** module id = 42\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\n\r\nmodule.exports = (relation_id) =>\r\n  new Promise((resolve, reject) => {\r\n    const sql = `\r\n      SELECT\r\n        object_id\r\n      FROM\r\n        ae.relation_partner\r\n      WHERE\r\n        relation_id = $1\r\n    `\r\n    app.db.many(sql, [relation_id])\r\n      .then((data) => {\r\n        if (data) return resolve(data)\r\n        reject(`no relation_partner received from db`)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getRelationPartnersByRelation.js\n ** module id = 43\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\n\r\nmodule.exports = () =>\r\n  new Promise((resolve, reject) => {\r\n    const sql = `\r\n      SELECT\r\n        *\r\n      FROM\r\n        ae.taxonomy\r\n    `\r\n    app.db.many(sql)\r\n      .then((data) => {\r\n        if (data) return resolve(data)\r\n        reject(`no taxonomies received from db`)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getTaxonomies.js\n ** module id = 44\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\n\r\nmodule.exports = (object_id) =>\r\n  new Promise((resolve, reject) => {\r\n    const sql = `\r\n      SELECT\r\n        ae.taxonomy.id,\r\n        ae.taxonomy.name AS taxonomy_name,\r\n        ae.taxonomy.description,\r\n        ae.taxonomy.links,\r\n        ae.taxonomy.last_updated,\r\n        ae.taxonomy.organization_id,\r\n        ae.taxonomy.category,\r\n        ae.taxonomy.is_category_standard,\r\n        ae.taxonomy_object.parent_id,\r\n        ae.taxonomy_object.name AS object_name,\r\n        ae.taxonomy_object.properties\r\n      FROM\r\n        ae.taxonomy_object\r\n        INNER JOIN ae.taxonomy\r\n        ON taxonomy.id = ae.taxonomy_object.taxonomy_id\r\n      WHERE\r\n        object_id = $1\r\n    `\r\n    app.db.many(sql, [object_id])\r\n      .then((data) => {\r\n        if (data) return resolve(data)\r\n        reject(`no object_taxonomies received from db`)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getTaxonomiesByObject.js\n ** module id = 45\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\n\r\nmodule.exports = () =>\r\n  new Promise((resolve, reject) => {\r\n    const sql = `\r\n      SELECT\r\n        *\r\n      FROM\r\n        ae.user\r\n    `\r\n    app.db.many(sql)\r\n      .then((data) => {\r\n        if (data) return resolve(data)\r\n        reject(`no users received from db`)\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/getUsers.js\n ** module id = 46\n ** module chunks = 0\n **/","'use strict'\r\n\r\n/**\r\n * builds an object of the form:\r\n * {\r\n *   id: xxx,\r\n *   category: xxx,\r\n *   organization_id: xxx,\r\n *   relationCollections: [\r\n *     {\r\n *       id: xxx,\r\n *       name: xxx,\r\n *       description: xxx,\r\n *       links: xxx,\r\n *       nature_of_relation: xxx,\r\n *       combining: xxx,\r\n *       organization_id: xxx,\r\n *       last_updated: xxx,\r\n *       terms_of_use: xxx,\r\n *       imported_by: xxx,\r\n *       relations: [\r\n *         {\r\n *           id: xxx,\r\n *           properties: xxx,\r\n *           relationPartners: [\r\n *             {\r\n *               object_id: xxx\r\n *             }\r\n *           ]\r\n *         }\r\n *       ]\r\n *     }\r\n *   ],\r\n *   propertyCollections: [\r\n *     {\r\n *       id: xxx,\r\n *       name: xxx,\r\n *       description: xxx,\r\n *       links: xxx,\r\n *       combining: xxx,\r\n *       organization_id: xxx,\r\n *       last_updated: xxx,\r\n *       terms_of_use: xxx,\r\n *       imported_by: xxx,\r\n *       properties: xxx\r\n *     }\r\n *   ],\r\n *   taxonomies: [\r\n *     {\r\n *       id: xxx,\r\n *       taxonomy_name: xxx,\r\n *       description: xxx,\r\n *       links: xxx,\r\n *       last_updated: xxx,\r\n *       organization_id: xxx,\r\n *       category: xxx,\r\n *       is_category_standard: xxx,\r\n *       parent_id: xxx,\r\n *       object_name: xxx,\r\n *       properties: xxx\r\n *     }\r\n *   ]\r\n * }\r\n */\r\n\r\nconst Boom = require('boom')\r\nconst getObjectById = require('../getObjectById.js')\r\nconst getRelationCollectionsByObject = require('../getRelationCollectionsByObject.js')\r\nconst getPropertyCollectionsByObject = require('../getPropertyCollectionsByObject.js')\r\nconst getTaxonomiesByObject = require('../getTaxonomiesByObject.js')\r\nconst escapeStringForSql = require('../escapeStringForSql.js')\r\n\r\nmodule.exports = (request, reply) => {\r\n  const id = escapeStringForSql(request.params.id)\r\n  let object\r\n\r\n  getObjectById(id)\r\n    .then((data) => {\r\n      object = data\r\n      return getRelationCollectionsByObject(id)\r\n    })\r\n    .then((relationCollections) => {\r\n      object.relationCollections = relationCollections\r\n      return getPropertyCollectionsByObject(id)\r\n    })\r\n    .then((propertyCollections) => {\r\n      object.propertyCollections = propertyCollections\r\n      return getTaxonomiesByObject(id)\r\n    })\r\n    .then((taxonomies) => {\r\n      object.taxonomies = taxonomies\r\n      return\r\n    })\r\n    .then(() => reply(null, object))\r\n    .catch((error) =>\r\n      reply(Boom.badImplementation(error), null)\r\n    )\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/handlers/objectById.js\n ** module id = 47\n ** module chunks = 0\n **/","module.exports = commonjsboom;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsboom\"\n ** module id = 48\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Boom = require('boom')\r\nconst getTaxonomies = require('../getTaxonomies.js')\r\n\r\nmodule.exports = (request, reply) => {\r\n  getTaxonomies()\r\n    .then((taxonomies) => {\r\n      if (taxonomies && taxonomies.length) {\r\n        return reply(null, taxonomies)\r\n      }\r\n      throw `no taxonomies received`  /* eslint no-throw-literal:0 */\r\n    })\r\n    .catch((error) =>\r\n      reply(Boom.badImplementation(error), null)\r\n    )\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/handlers/taxonomies.js\n ** module id = 49\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\nconst Boom = require('boom')\r\nconst hashPassword = require('../../hashPassword.js')\r\n\r\nmodule.exports = (request, reply) => {\r\n  const { name, email, password } = request.payload\r\n\r\n  hashPassword(password)\r\n    // save user in db\r\n    .then((hash) =>\r\n      app.db.none(`\r\n        INSERT INTO ae.user (name,email,password)\r\n        VALUES ('${name}','${email}','${hash}')\r\n      `)\r\n    )\r\n    .then(() =>\r\n      reply(`Ein neuer Benutzer Namens ${name} wurde erstellt`)\r\n    )\r\n    .catch((error) =>\r\n      reply(Boom.badImplementation(error), null)\r\n    )\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/handlers/users/create.js\n ** module id = 50\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst bcrypt = require('bcrypt')\r\n\r\nmodule.exports = (password) =>\r\n  new Promise((resolve, reject) => {\r\n    bcrypt.genSalt(10, (error, salt) => {\r\n      if (error) return reject(error)\r\n      bcrypt.hash(password, salt, (error2, hash) => {\r\n        if (error2) return reject(error2)\r\n        resolve(hash)\r\n      })\r\n    })\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/hashPassword.js\n ** module id = 51\n ** module chunks = 0\n **/","module.exports = commonjsbcrypt;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsbcrypt\"\n ** module id = 52\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Boom = require('boom')\r\nconst uuid = require('uuid')\r\nconst verifyUser = require('../../verifyUser.js')\r\n\r\nmodule.exports = (request, reply) => {\r\n  const { name, password } = request.payload\r\n  verifyUser(name, password)\r\n    .then((user) => {\r\n      console.log('login.js, user', user)\r\n      if (user === null || !Object.keys(user).length) {\r\n        return reply(Boom.unauthorized(`Ungültiger Name oder Passwort`))\r\n      }\r\n      delete user.password\r\n      // TODO: this produces an error\r\n      // find out, how to create a session and make hapi return a cookie\r\n      console.log(`request.auth`, request.auth)\r\n      const sid = uuid.v4()\r\n      request.cookieAuth.set({ sid })\r\n      reply(`Willkommen ${user.name}!`)\r\n    })\r\n    .catch(() => reply(Boom.badImplementation()))\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/handlers/users/login.js\n ** module id = 53\n ** module chunks = 0\n **/","module.exports = commonjsuuid;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsuuid\"\n ** module id = 54\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\nconst bcrypt = require('bcrypt')\r\n\r\nmodule.exports = (name, password) =>\r\n  new Promise((resolve, reject) => {\r\n    /**\r\n     * find a user in the db with this name\r\n     */\r\n    const sql = `\r\n      SELECT\r\n        *\r\n      FROM\r\n        ae.user\r\n      WHERE\r\n        name = $1\r\n    `\r\n    app.db.one(sql, [name])\r\n      .then((user) => {\r\n        if (!Object.keys(user)) {\r\n          return resolve()\r\n        }\r\n        bcrypt.compare(\r\n          password,\r\n          user.password,\r\n          (err, isValid) => {\r\n            console.log('isValid', isValid)\r\n            if (isValid) {\r\n              return resolve(user)\r\n            }\r\n            resolve(null)\r\n          }\r\n        )\r\n      })\r\n      .catch((error) => reject(error))\r\n  })\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/verifyUser.js\n ** module id = 55\n ** module chunks = 0\n **/","'use strict'\r\n\r\nmodule.exports = (request, reply) => {\r\n  request.cookieAuth.clear()\r\n  return reply(`erfolgreich abgemeldet`)\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/handlers/users/logout.js\n ** module id = 56\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Boom = require('boom')\r\nconst getUsers = require('../../getUsers.js')\r\n\r\nmodule.exports = (request, reply) => {\r\n  getUsers()\r\n    .then((users) => {\r\n      if (users && users.length) {\r\n        return reply(null, users)\r\n      }\r\n      throw `no users received`  /* eslint no-throw-literal:0 */\r\n    })\r\n    .catch((error) =>\r\n      reply(Boom.badImplementation(error), null)\r\n    )\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/handlers/users/users.js\n ** module id = 57\n ** module chunks = 0\n **/","'use strict'\r\n\r\nmodule.exports = [\r\n  {\r\n    method: `GET`,\r\n    path: `/{path*}`,\r\n    handler(request, reply) {\r\n      reply.file(`index.html`)\r\n    }\r\n  },\r\n  {\r\n    method: `GET`,\r\n    path: `/src/{param*}`,\r\n    handler: {\r\n      directory: {\r\n        path: `src`\r\n      }\r\n    }\r\n  },\r\n  {\r\n    method: `GET`,\r\n    path: `/style/{param*}`,\r\n    handler: {\r\n      directory: {\r\n        path: `style`\r\n      }\r\n    }\r\n  },\r\n  {\r\n    method: `GET`,\r\n    path: `/style/images/{param*}`,\r\n    handler: {\r\n      directory: {\r\n        path: `style/images`\r\n      }\r\n    }\r\n  }\r\n]\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/nonQueryRoutes/nonQueries.js\n ** module id = 58\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst exportData = require('../exportData.js')\r\n\r\nmodule.exports = {\r\n  method: `GET`,\r\n  path: `/exportData/{combineTaxonomies}/{oneRowPerRelation}/{includeDataFromSynonyms}/{onlyObjectsWithCollectionData}/{exportOptions}`,\r\n  handler: exportData\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/exportData.js\n ** module id = 59\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Joi = require('joi')\r\nconst objectById = require('../handlers/objectById.js')\r\n\r\nmodule.exports = {\r\n  method: `GET`,\r\n  path: `/object/{id}`,\r\n  handler: objectById,\r\n  config: {\r\n    validate: {\r\n      params: {\r\n        id: Joi.string().guid()\r\n      }\r\n    },\r\n    auth: false\r\n  }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/object.js\n ** module id = 60\n ** module chunks = 0\n **/","module.exports = commonjsjoi;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjsjoi\"\n ** module id = 61\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst taxonomies = require('../handlers/taxonomies.js')\r\n\r\nmodule.exports = {\r\n  method: `GET`,\r\n  path: `/taxonomies`,\r\n  handler: taxonomies,\r\n  config: {\r\n    auth: false\r\n  }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/taxonomies.js\n ** module id = 62\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Joi = require('joi')\r\nconst verifyUniqueUser = require('../../verifyUniqueUser.js')\r\nconst createUser = require('../../handlers/users/create.js')\r\n\r\nmodule.exports = {\r\n  method: `POST`,\r\n  path: `/users`,\r\n  handler: createUser,\r\n  config: {\r\n    pre: [\r\n      { method: verifyUniqueUser }\r\n    ],\r\n    validate: {\r\n      payload: {\r\n        name: Joi.string().min(2).max(200).required(),\r\n        email: Joi.string().email().required(),\r\n        password: Joi.string().min(2).max(200).required()\r\n      }\r\n    },\r\n    auth: false\r\n  }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/users/create.js\n ** module id = 63\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst app = require('ampersand-app')\r\nconst Boom = require('boom')\r\n\r\nmodule.exports = (request, reply) => {\r\n  const { name, email } = request.payload\r\n  /**\r\n   * Check whether the username or email\r\n   * is already taken and error out if so\r\n   */\r\n  const sql = `\r\n    SELECT\r\n      *\r\n    FROM\r\n      ae.user\r\n  `\r\n  app.db.many(sql)\r\n    .then((users) => {\r\n      const userWithSameName = users.find((user) => user.name === name)\r\n      const userWithSameEmail = users.find((user) => user.email === email)\r\n      if (userWithSameName) {\r\n        reply(Boom.badRequest('Der Benutzername wird schon verwendet'))\r\n      } else if (userWithSameEmail) {\r\n        reply(Boom.badRequest('Die Email-Adresse wird schon verwendet'))\r\n      } else {\r\n        /**\r\n         * everything checks out, so send the payload through\r\n         * to the route handler\r\n         */\r\n        reply(request.payload)\r\n      }\r\n    })\r\n    .catch((error) =>\r\n      reply(Boom.badImplementation(error))\r\n    )\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/verifyUniqueUser.js\n ** module id = 64\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Joi = require('joi')\r\nconst login = require('../../handlers/users/login.js')\r\n\r\nmodule.exports = {\r\n  method: `POST`,\r\n  path: `/users/login`,\r\n  handler: login,\r\n  config: {\r\n    validate: {\r\n      payload: {\r\n        name: Joi.string().min(2).max(200).required(),\r\n        password: Joi.string().min(2).max(200).required()\r\n      }\r\n    },\r\n    auth: false\r\n  }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/users/login.js\n ** module id = 65\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst logout = require('../../handlers/users/logout.js')\r\n\r\nmodule.exports = {\r\n  method: `GET`,\r\n  path: `/users/logout`,\r\n  handler: logout\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/users/logout.js\n ** module id = 66\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst users = require('../../handlers/users/users.js')\r\n\r\nmodule.exports = {\r\n  method: `GET`,\r\n  path: `/users`,\r\n  handler: users,\r\n  config: {\r\n    auth: {\r\n      strategy: `session`,\r\n      scope: [`admin`]\r\n    },\r\n    plugins: {\r\n      lout: false\r\n    }\r\n  }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/routes/users/users.js\n ** module id = 67\n ** module chunks = 0\n **/","module.exports = commonjspg-promise;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"commonjspg-promise\"\n ** module id = 123\n ** module chunks = 0\n **/"],"sourceRoot":""}